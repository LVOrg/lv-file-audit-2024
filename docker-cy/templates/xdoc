ARG BASE
#FROM jbarlow83/ocrmypdf:latest as ocr
#RUN rm -fr /usr/share/doc
FROM ${BASE}
ARG TARGETARCH
ARG OS

COPY ./../cy_consumers /app/cy_consumers

COPY ./../cy_utils /app/cy_utils
COPY ./../cy_xdoc /app/cy_xdoc
COPY ./../cyx /app/cyx
COPY ./../cy_vn_suggestion /app/cy_vn_suggestion
RUN python3 /app/compact.py /app/cy_vn_suggestion
COPY ./../resource /app/resource
COPY ./../config.yml /app/config.yml
COPY ./../dataset/easyocr /app/share-storage/dataset/easyocr
COPY ./../cy_controllers /apps/cy_controllers
RUN python3 -c 'import cv2'
#COPY --from=ocr /usr /usr
#RUN gs -h gs -?; exit 1
COPY ./../start.sh /app/start.sh
RUN chmod +x /app/start.sh
COPY ./../docker-cy/test /app
COPY ./../gradio_test /web
RUN chmod u+x /app/*.sh
RUN chmod u+x /web/*.sh
RUN python3 -m pip install phunspell
RUN python3 -m pip install fuzzywuzzy
RUN python3 -m pip install xmltodict
RUN python3 -m pip install xmltodict
RUN python3 -m  pip install fastapi-router-controller==0.5.0
WORKDIR /app
#   docker run -p 8012:8012 nttlong/py310-xdoc:amd.cpu.9.30.7 python3 /app/cy_xdoc/server.py
