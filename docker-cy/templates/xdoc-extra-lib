ARG BASE
FROM ${BASE}
ARG TARGETARCH
ARG OS
RUN mkdir /tmp-build && cd /tmp-build


COPY ./../docker-cy/templates/underthesea-core.sh /tmp-build/build.sh

RUN chmod u+x /tmp-build/build.sh
RUN if [ "$TARGETARCH" = "arm64" ]; then \
    /tmp-build/build.sh; \
    fi
# Install required packages
RUN python3 -m pip install underthesea
RUN python3 -m pip install fastapi-controller
#RUN if [ "$TARGETARCH" = "arm64" ]; then \
#    python3 -m pip install underthesea  --no-deps; \
#    fi
COPY ./../docker-cy/check/check_underthesea.py /app/check_underthesea.py
RUN python3 /app/check_underthesea.py
