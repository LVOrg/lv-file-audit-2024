# from cy_azure.services.ms_apps_services import MSAppService
# import cy_kit
# ms_app = cy_kit.singleton(MSAppService)
# app = ms_app.get_ms_app(
#     client_id="961f82fe-6c9f-45af-bd03-953940c2315e"
#
# )
# ms_app.init_auth_code_flow(
#     app=app,
#     scopes=["https://graph.microsoft.com/user.read"],
#     redirect_uri="https://172.16.13.72:8012/lvfile/api/lv-docs/azure/after_login"
# )
#
# auth_code_flow = app.initiate_auth_code_flow(scopes=["YOUR_SCOPES"], redirect_uri="https://172.16.13.72:8012/lvfile/api/lv-docs/azure/after_login")
#
# print(app)
from cy_azure.fwcking_ms import caller
token="eyJ0eXAiOiJKV1QiLCJub25jZSI6IlNXenQ4b3BfdzBPclR1MjByVXpkU1cwZEotVjlqdWZYR3BKbmx3VEZ5ZDQiLCJhbGciOiJSUzI1NiIsIng1dCI6IlQxU3QtZExUdnlXUmd4Ql82NzZ1OGtyWFMtSSIsImtpZCI6IlQxU3QtZExUdnlXUmd4Ql82NzZ1OGtyWFMtSSJ9.eyJhdWQiOiIwMDAwMDAwMy0wMDAwLTAwMDAtYzAwMC0wMDAwMDAwMDAwMDAiLCJpc3MiOiJodHRwczovL3N0cy53aW5kb3dzLm5ldC8xM2E1M2YzOS00YjRkLTQyNjgtOGM1ZS1hZTYyNjAxNzg5MjMvIiwiaWF0IjoxNzAxMTYwMDY2LCJuYmYiOjE3MDExNjAwNjYsImV4cCI6MTcwMTE2NTUxMCwiYWNjdCI6MCwiYWNyIjoiMSIsImFpbyI6IkFZUUFlLzhWQUFBQThaa0hkQ1F5c1pXcjFkcjB0aUNTeGxkUVRhZk9vLzhiMkQ1OEg3NmN5OWJtMk9WTCtCbVgzTmNWdDBhSUpYTzZWWkZyT2ZJYy9YMGhtWm1uQVZnenlGc0hXTzk3ZlNIdlJvUmZ0RWxmaTJES1dJNzFtYkFBZDhpMWNVazhIQyt3eldMUGJxcCtVOFZKQldKME9TTVYzWnlOMWg4L1R6b0NCeTJZbmpTRFQ2WT0iLCJhbHRzZWNpZCI6IjE6bGl2ZS5jb206MDAwMzdGRkVEMjVBRTYyMSIsImFtciI6WyJwd2QiXSwiYXBwX2Rpc3BsYXluYW1lIjoibHYtZG9jcy10ZXN0IiwiYXBwaWQiOiI5NjFmODJmZS02YzlmLTQ1YWYtYmQwMy05NTM5NDBjMjMxNWUiLCJhcHBpZGFjciI6IjEiLCJlbWFpbCI6Im50dGxvbmdAbGFjdmlldC5jb20udm4iLCJmYW1pbHlfbmFtZSI6Ik5ndXllbiBUcmFuIFRoZSIsImdpdmVuX25hbWUiOiJMb25nIiwiaWRwIjoibGl2ZS5jb20iLCJpZHR5cCI6InVzZXIiLCJpcGFkZHIiOiIxMjMuMjAuNzYuMTY3IiwibmFtZSI6IkxvbmcgTmd1eWVuIFRyYW4gVGhlIiwib2lkIjoiZjYzYzk3ZTktNmM5Zi00M2RmLWIyNjMtMzUxYWU5NDRkZWExIiwicGxhdGYiOiIzIiwicHVpZCI6IjEwMDM3RkZFOEZENEJGOEMiLCJyaCI6IjAuQVdRQU9ULWxFMDFMYUVLTVhxNWlZQmVKSXdNQUFBQUFBQUFBd0FBQUFBQUFBQUNRQUdrLiIsInNjcCI6IkRpcmVjdG9yeS5SZWFkV3JpdGUuQWxsIGVtYWlsIEZpbGVzLlJlYWQgRmlsZXMuUmVhZC5BbGwgRmlsZXMuUmVhZFdyaXRlIEZpbGVzLlJlYWRXcml0ZS5BbGwgb3BlbmlkIHByb2ZpbGUgU2l0ZXMuUmVhZFdyaXRlLkFsbCBVc2VyLlJlYWQiLCJzaWduaW5fc3RhdGUiOlsia21zaSJdLCJzdWIiOiIxNWE0TTZ3d214eUxpeDZZZmQyYWRobEprVnZKWVI5ZTc5cWRUMmxNOGhJIiwidGVuYW50X3JlZ2lvbl9zY29wZSI6IkFTIiwidGlkIjoiMTNhNTNmMzktNGI0ZC00MjY4LThjNWUtYWU2MjYwMTc4OTIzIiwidW5pcXVlX25hbWUiOiJsaXZlLmNvbSNudHRsb25nQGxhY3ZpZXQuY29tLnZuIiwidXRpIjoidWMtajZRbndaMDZOZ25rVmxJTmZBdyIsInZlciI6IjEuMCIsIndpZHMiOlsiNjJlOTAzOTQtNjlmNS00MjM3LTkxOTAtMDEyMTc3MTQ1ZTEwIiwiYjc5ZmJmNGQtM2VmOS00Njg5LTgxNDMtNzZiMTk0ZTg1NTA5Il0sInhtc19zdCI6eyJzdWIiOiIyNldZNW9rckxDY2Q5bjZMc0RWTk9lUEMzakVvWDJTQWZKSk9abDI2cG53In0sInhtc190Y2R0IjoxNDI4NDc1MzE1fQ.T4IaHlG1MPFPOwsE1T2f9mksk7HcUABKf3j6GWcEIk6xYLizvd95k-3_aDl9rwsFq7HE5hSDlIH2SRHW1noI_-D3hyR7Pn_hgF85zqD2AMxw0l4BDvwGVNUiEC2Hbty-nyHxr_kZth464h4EC_97eblGWtSrjaksiME5S6MDL_TPt9h7BmeZn8kEBALKc_mbNaMnt-dE0ZFCM4zJcUvxpMa9rdk03aosquzfibpbLwHzWpMhDVcjaVESIlMGGxU7PZQxi553Wh0t9fhb0LbnUTxnIgNYBFh70gteu9SK3C-tCEVR4Fc32IhqMzZZASrKowV-qtSjGbHxSd0UNPUu9g"
ret=caller.call_ms_func(
    method="get",
    token=token,
    api_url="me",
    return_type=dict,
    body=None,
    request_content_type=None
)
for k,v in ret.items():
    print(f"{k}={v}")
ret= caller.refresh_token(
    client_id="961f82fe-6c9f-45af-bd03-953940c2315e",
    client_secret="QwS8Q~3xRSO6DpFXbQpo8~RhfdcMZ1F9Uo.R6aRz",
    refresh_token="0.AWQAOT-lE01LaEKMXq5iYBeJI_6CH5afbK9FvQOVOUDCMV6QAGk.AgABAAEAAAAmoFfGtYxvRrNriQdPKIZ-AgDs_wUA9P9XxzdMclodhFl3tPWBQ6Bj2sgnYcZ2h4aj0jRHe-Ubz2W3-e02ISMNraScXSCYQ7rztd2MOqU0nbqlWMJY_eCZNN-QBKlNeUqaUvnYWiXrusHZV_Znh52jzKcTFTkNrs2JbJ565RI7sBOS1rIpF6J_Pm-_WZkawAU94YahdRe9-NI4Ua2h1Wt-KPmv6kBGSFqj8VMmQ6INAyF6dDeNyf5kjua5Ze-iB5RfDl9YsAepq9tt8kocX3rUQvEDZD5z9Pr3cO8HZKvZnDUig6fhZfw81HbIAwTOB8GX6jRGIlWZyG2EBVA7JVsV2dSLPj1mnX2viGCcSVAl36n8dqvmGHh0hmXTfXaHdWj5DQJO4cgcjUDPRogGqC-82E2zl7iu7BoZAmLJ3Cd5gRAII5VYHvjDn8Bx_LlZD40p6rDZqOkx5XNe-brDMoWHehrNmX90B77l1Wr9FcD_Cbuz5N_CCWj-37EwBhDdBxmcr1FW1QbfRrhlsM_PGHtgi9mydc1z4lhcIM-ThCxJm72irePmCtgpWWrXtIWZ69HSzFTU4R5HIONV5m4hnKGBgOrc4V1i9JYRrDch9lEOevn_8IU374rCQH51jXp3OYu6SiTnjIW5lCaob4zYiHGYIz-5B1PX_Ao391kYgU4zUyXFczUWgdxnavNnXDR4vV_dSScZNt62p7-_R8gjsSeAh-ZljJVaVW83iFTuJ-StGlrye1NU2W1xU2qfXj5v5BbxKyQS93dwo8KccVQt4JKPTJmVJJPhI680mdbwmidToASbNTNe-TVsr9zhPlK_kOqiCudN_zNOaqaT4AaecUCaumdoPPDoLQfihCa5D08k-boW1xMMUtVSB23rEvgyuVEWYKTo6GUMUPMfCTkljPQhTZb6h2R9EPPHm3sfwlkSagvZDNPTQedFrC-ecSpWstwS2F9f84t8nuY8TPYT2sKx0xVeAj-hBiqEliD8Uy7WRko__SOSyAHcu-GjT32X6Pp0K8Rt08W9vJihDdLJQV8VdH0261CfquZepZ8NmblHNtYmXBKOecOkuurxuQNTAZC8NH4Rd4ADRH9aX4On4-yqk7RGzYRQWWGYQHGURdxMhY7v5eNMfMurx5R91i7zU3DdgwjjOd4Jq4fox65cStp7PoZ1BB5s4ub_LYq06g9z4dEO52iMV_Up1KxABNYCdy5oben2d524Nonp7IOo5FDIdP6ihtDSbKGuWMytzyboIKv8j01txGz6ODeUPeVlDOstzZSJDq_85hDq1reD1DvrOT1tK_RBAM_Z4sU5ovrjXov7GCsc3mSIhv6VInrTQTdfmHBSD8C3Mo-j3BxLN2j-JyCICXTV4ObGSbvkU_mk0HHFCzFSA3fT-j_XdVfrrZq1EaQWdeHvkQ-WnVsb0LGHhw0hB5OpQfXszH8QOU3TDGqq_4DayIEHjKInGP5Mlg"
)
print(ret)